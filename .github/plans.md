## Fin-Infra Web – Experience Differentiation Plan (v4)

### Vision

Deliver a personal-finance cockpit that feels as polished as Monarch Money or Quicken Simplifi: data-import ready, hyper-personalized, and emotionally reassuring. Every surface should adapt to the member’s goals, highlight actionable insights, and provide confident automation with human-friendly explanations.

### Current Experience Observations

* **Fragmented onboarding:** Pages assume fully populated mocks. There is no guided setup, institution linking, or first-use scaffolding in `app/(dashboard)/overview/page.tsx` or the layout shell. The sidebar immediately exposes every page, overwhelming new members.
* **Insight system lacks memory:** `InsightCard` and `lib/insights/definitions.ts` centralize copy, but there is no persistence of pin/resolution state across sessions, no prioritization by persona, and little feedback loop into charts or goal projections.
* **Charts focus on static snapshots:** Dynamic imports (e.g., `Overview` loading `PerformanceTimeline` and `CashFlow`) protect performance, but there is no scenario comparison, goal overlays, or natural language summaries to build trust in automated recommendations.
* **Mobile ergonomics are thin:** `DashboardLayout` + `Sidebar` rely on large-screen real estate; mobile uses a slide-in drawer with minimal optimization and no contextual quick actions. Critical tables (transactions, accounts) are wide and rely on virtualization without stacked card fallbacks.
* **Design language is cohesive but generic:** Tokens in `app/globals.css` give us a solid base, yet the brand voice (colors, iconography, typography) mirrors boilerplate fintech dashboards. Empty states, celebratory moments, and risk alerts need motion, illustration, and tone to create an emotional hook.
* **Security & trust messaging is implicit:** Privacy toggles exist in the top bar, but there is no surfaced audit trail, alerting, or security center to reassure members their sensitive data is handled with care.

### Guiding Principles

1. **Adaptive journey:** Surfaces respond to lifecycle stage (onboarding, day-to-day tracking, planning, troubleshooting).
2. **Explainable automation:** Every proactive action (rebalance, savings adjustment, tax harvest) includes plain-language justification plus metrics members can interrogate.
3. **Delight with restraint:** Motion, theming, and celebration should reinforce confidence without distracting from financial clarity.
4. **Mobile-first rigor:** No new feature ships without small-screen ergonomics, offline empathy, and high-contrast accessibility.
5. **Data dignity:** Treat every balance, document, and decision as sensitive—mask by default, log responsibly, and hand members the controls.

---

### Workstreams

#### WS-A – Guided Onboarding & Money Graph Foundation

Goal: Turn the first session into a structured setup that connects accounts, sets intents, and seeds personalization.

Deliverables

- [x] Multi-step onboarding flow under `app/(auth)/onboarding` with progress tracker, account aggregation placeholders, and persona questions (goals, risk tolerance, budgeting style).
- [x] Institution linking simulation (Plaid-style modal) wired to mock services in `lib/services` with optimistic UI states, retry flows, and masked values tied to `usePrivacy`.
- [x] Money Graph schema in `types/domain.ts` and `lib/mock` describing relationships (accounts → transactions → goals) to power contextual recommendations.
- [x] Onboarding completion state persisted via secure storage hooks (`lib/security/use-secure-storage`) and reflected in `DashboardLayout` (e.g., badges that show setup progress until complete).

Acceptance Criteria

- [x] Members who skip onboarding land on an “empty dashboard” state with guided actions.
- [x] Persona answers influence default insights and KPI tiles across Overview, Budget, Goals.

#### WS-B – Personalized Dashboards & Goal Planning

Goal: Reshape core surfaces to feel tailored—focus on contextual KPIs, plan progress, and next-best actions.

Deliverables

- [ ] Adaptive `KPICards` variants that swap metrics based on persona (e.g., debt payoff vs. wealth building) and highlight urgency via iconography.
- [ ] Timeline overlays within `PerformanceTimeline` that compare actual vs. planned milestones, plus copy generated by a lightweight insights summarizer in `lib/insights/service`.
- [ ] Goal planner revamp in `app/(dashboard)/goals` featuring stacked cards per goal, sliders with scenario snapshots, and celebratory states when milestones are hit.
- [ ] Budget & Cash Flow modules that surface recurring risk (cash burn warnings, savings streaks) and link directly to actionable toggles (auto-transfer, category adjustments).

Acceptance Criteria

- [ ] Persona-specific dashboards validated via storybook-like fixtures.
- [ ] Goal completion triggers celebratory animation + shareable summary.

Implementation Tasks

- [ ] Overview: Update card grid layout separators and consistent icon sizing via `OverviewCard`.
- [ ] Overview: Add “View details” CTAs linking to `/portfolio`, `/accounts`, `/cash-flow`, etc.
- [ ] Overview: Embed 7-day sparkline mini-charts inside KPI cards.
- [ ] Overview: Refresh Portfolio Health tabs with clear active/inactive styles and keyboard nav.
- [ ] Accounts: Increase summary card typography hierarchy and align iconography; optional mini-charts.
- [ ] Accounts: “All Insights” collapse/expand with persisted state; reduce default footprint.
- [ ] Accounts: Table enhancements with sortable headers and filters (type, institution).
- [ ] Portfolio: Annotate interactive metrics (Sharpe, beta) with info icons and explanations modal.
- [ ] Portfolio: Group AI insights by category with accordion expand/collapse (low-priority collapsed).
- [ ] Cash Flow: Replace/augment charts with stacked bar/area for inflows vs outflows.
- [ ] Cash Flow: Add insight pin/unpin with `useSecureStorage` persistence.
- [ ] Transactions: Update actionable insight cards with primary/secondary buttons and dismiss/resolve.
- [ ] Transactions: Extend table with customizable columns, advanced filters, and search hints.
- [ ] Budget: Add progress ring snapshot; ensure color contrast.
- [ ] Budget: For over-budget categories, add mini bar chart (actual vs planned) + tooltip.
- [ ] Budget: Update insights copy to encourage corrective actions; validate responsiveness.
- [ ] Goals: Aggregate progress with bars/rings and monthly contribution summaries.
- [ ] Goals: Filters for active/completed goals via accessible segmented control.
- [ ] Goals: “Add Goal” modal wizard with validation and success state.
- [ ] Insights: Implement filter tabs (All, Spending Trends, Investment Health, Goals Forecast) and fuzzy search.

#### WS-C – Automation Copilot & Scenario Playbooks

Goal: Introduce explainable automations that help members act with confidence.

Deliverables

- [ ] Copilot drawer component (extending `AIChatSidebar`) that proposes automations (rebalance, savings sweep, tax harvest) with diff previews and risk badges.
- [ ] Scenario playbooks for Taxes, Investments, and Budget that let members compare 2–3 parameterized cases side-by-side (componentized comparison table & charts).
- [ ] Action confirmation modals using `@/components/ui/dialog` that summarize benefits, trade-offs, and allow scheduling.
- [ ] Event instrumentation in `lib/analytics/events` capturing acceptance/decline reasons, feeding back into insights ranking.

Acceptance Criteria

- [ ] Copilot suggestions show before/after metrics referencing Money Graph data.
- [ ] Automations require explicit confirmation, provide undo toast, and log to a history timeline.

Implementation Tasks

- [ ] Portfolio: Provide quick action buttons within each insight (e.g., “Rebalance now”) linking to automation/scenario flows.
- [ ] Crypto: When holdings concentration is high, surface diversification CTA linking to rebalancing guide.
- [ ] Taxes: Add timeline of key deadlines with icons and tooltips.
- [ ] Taxes: Add “Why?” explanation links opening modal/drawer with rationale and data sources.
- [ ] Taxes: Ensure automated actions integrate with Copilot for harvest or document reminders.

#### WS-D – Collaboration, Accountability & Shared Spaces

Goal: Support households and advisors with shared visibility, tasking, and accountability loops.

Deliverables

- [ ] Shared workspace switcher in `TopBar` avatar menu for multi-member households, with access roles defined in `types/domain.ts`.
- [ ] Comments & mentions drawer for transactions, goals, and documents leveraging `@/components/ui/textarea` + presence indicators.
- [ ] Accountability checklist widgets (due bills, tasks) integrated into Overview and Documents with reminders.
- [ ] Notification center revamp that groups alerts by workspace and channel (email, push) using `components/ui/tabs`.

Acceptance Criteria

- [ ] Every actionable card exposes “Assign” or “Share” affordances respecting permissions.
- [ ] Activity log aggregates tasks, comments, and automations with filters.

Implementation Tasks

- [ ] Documents: Provide document type chips/tags with multi-select filtering; filter by year/account with persistent state.

#### WS-E – Mobile, Offline & Performance Polish

Goal: Ensure parity across device sizes and resilience under poor connectivity.

Deliverables

- [ ] Mobile-first layout variant: bottom navigation for <768px, collapsible KPI summaries, cardified tables (Transactions, Accounts).
- [ ] Offline-ready states (skeletons, “last synced” badges) using service worker mock or fallback store.
- [ ] Performance budgets integrated into CI (`next/bundle-analyzer`, React Profiler snapshots for charts) with thresholds.
- [ ] Skeleton & shimmer audit to ensure every major surface has loading placeholders tailored to content height.

Acceptance Criteria

- [ ] Lighthouse mobile performance ≥ 85 in dev build for Overview, Transactions, Goals.
- [ ] Offline mode surfaces stale data banners and disables automations gracefully.

Implementation Tasks

- [ ] Global: Implement standardized card padding/margins in shared card primitives with responsive adjustments.
- [ ] Global: Extend responsive mixins to ensure cards stack and sidebars collapse on <1024px widths.
- [ ] Overview: Verify performance chart accessibility; add aria labels, tooltip descriptions, and mobile stacking.
- [ ] Accounts: Implement sticky table header for long lists.
- [ ] Accounts: Ensure responsive card fallback for narrow screens (stacked account summaries).
- [ ] Cash Flow: Optimize layout for mobile stacking; ensure axis labels meet contrast standards.
- [ ] Transactions: Implement sticky filters/search bar with aria-live updates.
- [ ] Home: Smooth scrolling between hero and features; subtle on-scroll animations within budgets.

QA & Validation

- [ ] Run automated accessibility audits (axe-core) on updated pages and components.
- [ ] Execute Lighthouse checks for desktop and mobile focusing on performance/accessibility thresholds.

#### WS-F – Brand, Emotion & Trust Layer

Goal: Distinguish Fin-Infra visually and emotionally while reinforcing security.

Deliverables

- [x] Brand elevation: refine `app/globals.css` tokens, introduce gradient backgrounds, iconography set, and typographic hierarchy that differentiates wealth vs. cash flows.
- [x] Story-driven empty states & success modals with illustrations, microcopy, and confetti/motion primitives.
- [x] Security center page in `app/(dashboard)/settings/security` showing login history, privacy toggles, and export/download controls.
- [x] Compliance-ready copy & tooltips for sensitive metrics leveraging `InsightCard` `redactedBody` and `fallbackValue` fields.

Acceptance Criteria

- [ ] Usability tests show improved task confidence vs. baseline mocks.
- [ ] Security center reduces support burden by surfacing answers to “who can see my data?”

Implementation Tasks

- [x] Global: Audit spacing, font, and color tokens usage across `app/globals.css`, `styles/themes`, and shared UI.
- [x] Global: Define updated spacing scale and typography ramp; document in `docs/design-tokens.md` and update CSS variables.
- [x] Global: Validate accent color contrast against WCAG AA; adjust success/danger palettes and delta text components.
- [x] Global: Confirm single font-family usage; remove redundant imports; enforce heading/body styles.
- [x] Global: Build reusable tooltip description map in `lib/tooltips`; apply to flagged data points.
- [x] Global: Introduce dark-mode + font-size preference control in Settings and propagate variables.
- [x] Overview: Confirm tooltips for net worth, investable assets, cash, debt, daily P/L, credit score use updated copy.
- [x] Documents: Enlarge drag-and-drop CTA, list accepted file types/sizes, and ensure keyboard operability.
- [x] Documents: Provide aria descriptions for upload feedback and error states.
- [x] Settings: Standardize toggle styling for notifications with helper text.
- [x] Settings: Build appearance settings for light/dark mode, font sizing, and dyslexia-friendly option.
- [x] Settings: Integrate Security Center into navigation with consistent visual language.
- [x] Home: Responsive hero typography clamp values; accessible/focus styles for buttons; sticky nav with logo/CTA.
- [x] Home: Align feature highlight cards (consistent icons) and add hover states linking to details.
- [x] Home: Insert social proof (logos/testimonial) near final CTA; single primary button to sign-up.

QA & Validation

- [ ] Conduct component-level Storybook/Chromatic reviews for updated UI primitives and patterns.

#### WS-G – Measurement, Experiments & Growth

Goal: Close the loop with data-driven decisions and growth levers.

Deliverables

- [ ] Experimentation hooks (feature flags) in `lib/analytics` + `.env.example` for gating new flows.
- [ ] Cohort dashboards summarizing activation, retention, automation adoption; include instrumentation for onboarding drop-off.
- [ ] In-app feedback moments (post-automation, after onboarding) collecting qualitative signals with Sonner toasts + modal forms.
- [ ] Share/export features (PDF summaries, CSV exports) that capture attribution when members share progress externally.

Acceptance Criteria

- [ ] PRD-ready dashboards exist for onboarding funnel and automation usage.
- [ ] Feedback loops feed into insights ranking algorithm.

Implementation Tasks

- [ ] Insights: Highlight new/unread insights via badges or accent border; persist state per member.
- [ ] Insights: Attach recommended actions with one-click triggers (with confirmation) and track analytics events.

QA & Validation

- [ ] Verify analytics events fire for new CTAs, filters, and automations using `lib/analytics/events` mocks.
- [ ] Update documentation (`docs/release-notes.md`, `docs/design-tokens.md`) summarizing UX enhancements.
- [ ] Collect qualitative feedback post-onboarding and post-automation via toasts/modal forms.

---

### Milestones & Sequencing

* **M1 (Weeks 1–2):** WS-A foundations + Money Graph schema, deliver onboarding skeleton + persona-driven KPIs. Begin brand token refresh.
* **M2 (Weeks 3–4):** WS-B personalization + WS-E mobile layout updates. Launch celebratory states and offline banners.
* **M3 (Weeks 5–6):** WS-C automation copilot + WS-G instrumentation. Ship scenario playbooks and measurement dashboards.
* **M4 (Weeks 7–8):** WS-D collaboration + WS-F trust center. Conduct usability validation and finalize animation/microcopy polish.

### Success Metrics

* **Activation:** ≥80% of new members complete onboarding and link ≥2 accounts.
* **Engagement:** 2× increase in weekly active automations with <5% cancellation rate.
* **Confidence:** Post-action feedback averages ≥4.5/5 on clarity and trustfulness.
* **Retention:** Households using shared spaces retain at 120% vs. individual baseline.
* **Performance:** Mobile INP < 200ms on high-interaction pages; no accessibility regressions (axe clean across routes).

---

### Page & Surface Enhancement Checklist

The following breakdown translates the qualitative UX guidance into executable tasks. Each sub-list is ordered for sequential delivery and references relevant components or directories for quick navigation.

#### Global Design System (applies across all routes)

All tasks have been reorganized under Workstreams (see WS-E and WS-F Implementation Tasks).

#### Overview Dashboard (`app/(dashboard)/overview`)

Tasks moved under Workstreams WS-B, WS-E, and WS-F.

#### Accounts Page (`app/(dashboard)/accounts`)

Tasks moved under Workstreams WS-B and WS-E.

#### Portfolio Page (`app/(dashboard)/portfolio`)

Tasks moved under Workstreams WS-B, WS-C, and WS-E.

#### Crypto Page (`app/(dashboard)/crypto`)

Tasks moved under Workstreams WS-B and WS-C.

#### Cash Flow Page (`app/(dashboard)/cash-flow`)

Tasks moved under Workstreams WS-B and WS-E.

#### Transactions Page (`app/(dashboard)/transactions`)

Tasks moved under Workstreams WS-B and WS-E.

#### Budget Page (`app/(dashboard)/budget`)

Tasks moved under Workstream WS-B.

#### Goals Page (`app/(dashboard)/goals`)

Tasks moved under Workstream WS-B.

#### Taxes Page (`app/(dashboard)/taxes`)

Tasks moved under Workstream WS-C.

#### Insights Page (`app/(dashboard)/insights`)

Tasks moved under Workstreams WS-B and WS-G.

#### Documents Page (`app/(dashboard)/documents`)

Tasks moved under Workstreams WS-D and WS-F.

#### Settings Page (`app/(dashboard)/settings`)

Tasks moved under Workstream WS-F.

#### Home/Landing Page (`app/page.tsx` + related components)

Tasks moved under Workstreams WS-F and WS-E.

---

### Validation & QA

Tasks are distributed under Workstreams: WS-E (accessibility/performance), WS-F (storybook/design review), WS-G (analytics, docs, feedback).

